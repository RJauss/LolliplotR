# LolliplotR
R Package for generating publication ready lolliplots based on genetic variants

## Introduction

### Functions overview

To generate a lolliplot, we use 4 different functions outlined here: 

![Functions Overview](images/functions_overview.png)

### `import_cohort`

This function imports your cohort from a .tsv or .csv file. Include as much information as possible, but the only mandatory value is the **p. code** of your variants you want to plot. 

An example of how the cohort data could look like is: 

| Person ID | variant_c | **variant_p**  | origin    | zygosity     |
|-----------|-----------|------------|-----------|--------------|
| P1        | c.123A>T  | **p.Arg41Thr** | de novo   | heterozygous |
| P2        | c.456G>T  | **p.Cys152Ter**  | inherited | homozygous   |

The more details you provide, the more aesthetics you can use for the plotting, which will be discussed later.

### `get_clinvar`

This function gets the ClinVar variants for your gene of interest. Simply provide the gene name and the minimum clinical significance at which the variants should be retained.

### `get_gnomad`

This function uses the gnomAD API to get the gnomad Variants for your gene of interest. It returns a dataframe suitable for the density-plotting in ggplot.

### `get_domains`

This function uses the Uniprot API to retrieve the Pfam domains for your gene of interest.

### `plot_lolliplot`

This function then does the plotting. It takes the data generated by the functions above and also takes aesthetics arguments for the plotting. 

## Usage and examples

First import the cohort. You can also use the example dataset provided in the package:

```r
examplepath = system.file("extdata", "LRP6_patient_variants.csv", package="LolliplotR")
LRP6_cohort = import_cohort(path_to_cohort = examplepath, p_code_column = "variant_p"
```

Then get the ClinVar variants, gnomAD data and domains for *LRP6*

```r
LRP6_clinvar = get_clinvar("LRP6")
LRP6_gnomad = get_gnomad(gene = "LRP6", outlier_shrinkfactor = 100)
LRP6_domains = get_domains("LRP6")
```

Now we do the plotting. 

```r
LRP6_lolliplot = plot_lolliplot(cohort = LRP6_cohort, domains = LRP6_domains, 
clinvar = LRP6_clinvar, gnomad = LRP6_gnomad, .linetype = "origin_simple")
```

And have a look at the results:

![LRP6 Lolliplot](images/LRP6_Lolliplot.png)

